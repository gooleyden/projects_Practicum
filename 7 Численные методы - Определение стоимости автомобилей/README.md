# Определение стоимости автомобилей

**Описание**

Сервис по продаже автомобилей с пробегом разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля. В нашем распоряжении исторические данные: технические характеристики, комплектации и цены автомобилей. Необходимо построить модель для определения стоимости. 

Заказчику важны:

- качество предсказания;
- скорость предсказания;
- время обучения.
______
**Цель:**
- Построить модель МО, которая будет определять цену автомобиля по входным признакам, с учетом требований качества, указанных заказчиком.
_________
**Задача:**
- Построить несколько моделей машинного обучения, включая LightGBM. Для каждой:
    - Достичь значения метрики RMSE менее 2500
    - Определить скорость обучения, предсказания
- Выбрать лучшую модель, в соответствии с требованиями заказчика
- Проверить лучшую модель на тестовой выборке
_____________
**План работы:**
1. Подготовка данных
2. Обучение моделей
3. Анализ моделей и выбор лучшей
4. Проверка лучшей модели на тестовых данных
_____________
**Признаки:**
- дата скачивания анкеты из базы; тип автомобильного кузова; год регистрации автомобиля; тип коробки передач; мощность (л. с.); модель автомобиля; пробег (км); месяц регистрации автомобиля; тип топлива; марка автомобиля; была ли машина в ремонте (да/нет); дата создания анкеты; количество фотографий автомобиля; почтовый индекс владельца анкеты (пользователя); дата последней активности пользователя

**Целевой признак**
- цена (евро)

_______________________

# Результат работы

Построены модели и выбрана лучшая по соотношению качества и скоростей обучения и предсказания:
- **LGBMRegressor(learning_rate=0.159, max_depth=15, n_estimators=519)**

Её результаты:
1. На валидационной выборке:
    - RMSE:  1626.53
    - Время обучения:  14.58 с 
    - Время предсказания:  1.93 с
2. На тестовой выборке:
    - RMSE:  1588.03
    - Время предсказания:  1.95 с

Сравнение цен реальных и предсказанных после кросс-валидации:
<img width="831" alt="image" src="https://github.com/user-attachments/assets/07cef347-7d96-4387-882b-ca0400bf20a7" />

Анализ остатков после кросс-валидации (распределение разницы между реальными и предсказанными значениеми цен):
<img width="831" alt="image" src="https://github.com/user-attachments/assets/229ca3ea-3edb-48f5-9a86-0b4881c8f152" />


    
